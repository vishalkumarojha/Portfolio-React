<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <base target="_top">
  <script>
    // This is the Google Apps Script code that should be deployed as a web app
    // Copy this code to a new Google Apps Script project and deploy it as a web app
    
    function doGet(e) {
      return HtmlService.createHtmlOutputFromFile('form');
    }
    
    function doPost(e) {
      try {
        // Open the spreadsheet by ID
        var ss = SpreadsheetApp.openById("1BbmZgPULQrm4dBqExlGSWn7TVM4cngeMEVY8e8aUPQI");
        var sheet = ss.getSheetByName("Sheet1") || ss.getSheets()[0];
        
        // Get form data
        var email = e.parameter.email;
        var timestamp = e.parameter.timestamp || new Date().toISOString();
        
        // Add data to the spreadsheet
        sheet.appendRow([timestamp, email]);
        
        return HtmlService.createHtmlOutput("Success! Your email has been added to our newsletter.");
      } catch(error) {
        return HtmlService.createHtmlOutput("Error: " + error.message);
      }
    }
  </script>
</head>
<body>
  <div>
    <h2>Newsletter Subscription</h2>
    <p>This is the backend script for the newsletter subscription form.</p>
  </div>
</body>
</html>

