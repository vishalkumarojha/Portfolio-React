<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <base target="_top">
  <script>
    // This is the Google Apps Script code that should be deployed as a web app
    // Copy this code to a new Google Apps Script project and deploy it as a web app
    
    function doGet(e) {
      return HtmlService.createHtmlOutputFromFile('form');
    }
    
    function doPost(e) {
      try {
        // Open the spreadsheet by ID
        var ss = SpreadsheetApp.openById("1ssrIiZvBo6PL0wBrCOxnBBSVG4Q65Iwy3uC1I0eU6_4");
        var sheet = ss.getSheetByName("Contact Form") || ss.getSheets()[0];
        
        // Get form data
        var name = e.parameter.name || "";
        var email = e.parameter.email || "";
        var subject = e.parameter.subject || "";
        var message = e.parameter.message || "";
        var timestamp = e.parameter.timestamp || new Date().toISOString();
        var formType = e.parameter.form || "contact";
        
        // Add data to the spreadsheet
        if (formType === "contact") {
          sheet.appendRow([timestamp, name, email, subject, message]);
        } else if (formType === "newsletter") {
          // If you want to use a different sheet for newsletter
          var newsletterSheet = ss.getSheetByName("Newsletter") || ss.insertSheet("Newsletter");
          newsletterSheet.appendRow([timestamp, email]);
        }
        
        return HtmlService.createHtmlOutput("Success! Your message has been sent.");
      } catch(error) {
        return HtmlService.createHtmlOutput("Error: " + error.message);
      }
    }
  </script>
</head>
<body>
  <div>
    <h2>Contact Form Submission</h2>
    <p>This is the backend script for the contact form.</p>
  </div>
</body>
</html>

